# =============================================================================
# Malware Signature Patterns — Windows Forensic Scanner
# =============================================================================
# Each line is a path pattern or indicator that may signal malicious activity.
# The scanner converts backslashes to forward slashes and resolves wildcards.
# Lines beginning with # are comments; blank lines are ignored.
# =============================================================================

# ---------------------------------------------------------------------------
# Section 1: Persistence — Scheduled Tasks
# ---------------------------------------------------------------------------
C:\Windows\System32\Tasks\*
C:\Windows\SysWOW64\Tasks\*
C:\Windows\System32\config\SAM
C:\Windows\Tasks\*

# ---------------------------------------------------------------------------
# Section 2: Persistence — Autorun Registry Hive Paths
# ---------------------------------------------------------------------------
# NTUSER.DAT contains per-user Run/RunOnce keys
C:\Users\*\NTUSER.DAT
# SOFTWARE hive contains machine-wide Run/RunOnce keys
C:\Windows\System32\config\SOFTWARE
# CurrentVersion\Run, RunOnce, RunServices, Policies\Explorer\Run
# (parsed from hives by the scanner's registry analysis module)

# ---------------------------------------------------------------------------
# Section 3: Persistence — Services Hive Paths
# ---------------------------------------------------------------------------
C:\Windows\System32\config\SYSTEM
# SYSTEM\CurrentControlSet\Services examined for unknown service entries

# ---------------------------------------------------------------------------
# Section 4: Persistence — Startup Folders
# ---------------------------------------------------------------------------
C:\Users\*\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup\*
C:\ProgramData\Microsoft\Windows\Start Menu\Programs\StartUp\*

# ---------------------------------------------------------------------------
# Section 5: Suspicious Binaries — Temp / AppData / ProgramData
# ---------------------------------------------------------------------------
C:\Users\*\AppData\Local\Temp\*.exe
C:\Users\*\AppData\Local\Temp\*.dll
C:\Users\*\AppData\Local\Temp\*.scr
C:\Users\*\AppData\Local\Temp\*.bat
C:\Users\*\AppData\Local\Temp\*.cmd
C:\Users\*\AppData\Local\Temp\*.vbs
C:\Users\*\AppData\Local\Temp\*.js
C:\Users\*\AppData\Local\Temp\*.ps1
C:\Users\*\AppData\Roaming\*.exe
C:\Users\*\AppData\Local\*.exe
C:\ProgramData\*.exe
C:\ProgramData\*.dll

# ---------------------------------------------------------------------------
# Section 6: Double Extensions (social-engineering trick)
# ---------------------------------------------------------------------------
C:\Users\*\**\*.pdf.exe
C:\Users\*\**\*.doc.exe
C:\Users\*\**\*.jpg.exe
C:\Users\*\**\*.txt.exe
C:\Users\*\**\*.xlsx.exe
C:\Users\*\**\*.mp3.exe
C:\Users\*\**\*.avi.exe
C:\Users\*\**\*.png.scr

# ---------------------------------------------------------------------------
# Section 7: svchost.exe Copies Outside System32
# ---------------------------------------------------------------------------
C:\Users\*\**\svchost.exe
C:\ProgramData\*\svchost.exe
C:\Temp\svchost.exe
C:\Windows\Temp\svchost.exe
C:\Users\*\AppData\*\svchost.exe
# Legitimate location for reference: C:\Windows\System32\svchost.exe

# ---------------------------------------------------------------------------
# Section 8: Rootkit Indicators — Unsigned / Suspicious Drivers
# ---------------------------------------------------------------------------
C:\Windows\System32\drivers\*.sys
C:\Windows\SysWOW64\drivers\*.sys
# Hidden system directories that should not normally exist:
C:\Windows\System32\drivers\etc\hosts.bak
C:\Windows\System32\drivers\etc\hosts.txt

# ---------------------------------------------------------------------------
# Section 9: Hidden Directories in System Paths
# ---------------------------------------------------------------------------
C:\Windows\System32\.*\
C:\Windows\.*\
C:\ProgramData\.*\
C:\Users\*\AppData\Local\.*\

# ---------------------------------------------------------------------------
# Section 10: WMI Persistence
# ---------------------------------------------------------------------------
C:\Windows\System32\wbem\Repository\OBJECTS.DATA
C:\Windows\System32\wbem\Repository\INDEX.BTR
C:\Windows\System32\wbem\Repository\MAPPING*.MAP
C:\Windows\System32\wbem\AutoRecover\*.mof

# ---------------------------------------------------------------------------
# Section 11: PowerShell Scripts in Unusual Locations
# ---------------------------------------------------------------------------
C:\Windows\Temp\*.ps1
C:\Users\*\AppData\Local\Temp\*.ps1
C:\ProgramData\*.ps1
C:\Users\*\Downloads\*.ps1
C:\Users\*\Desktop\*.ps1
C:\Windows\System32\*.ps1

# ---------------------------------------------------------------------------
# Section 12: Encoded PowerShell Indicators
# ---------------------------------------------------------------------------
# Files containing -EncodedCommand / -enc / FromBase64String (content scan)
# The scanner greps for these patterns inside .ps1, .bat, .cmd files:
# CONTENT_SCAN:*.ps1:EncodedCommand
# CONTENT_SCAN:*.bat:-enc
# CONTENT_SCAN:*.cmd:FromBase64String
# CONTENT_SCAN:*.vbs:powershell
# CONTENT_SCAN:*.js:WScript.Shell

# ---------------------------------------------------------------------------
# Section 13: Alternate Data Streams Marker
# ---------------------------------------------------------------------------
# ADS are detected by the scanner using ntfs-3g getfattr / streams
# Marker pattern for files known to use ADS for hiding payloads:
# ADS_SCAN:C:\Users\*\Downloads\*
# ADS_SCAN:C:\Users\*\Desktop\*
# ADS_SCAN:C:\ProgramData\*

# ---------------------------------------------------------------------------
# Section 14: Browser Extension Malware Paths
# ---------------------------------------------------------------------------
# Chrome extensions
C:\Users\*\AppData\Local\Google\Chrome\User Data\Default\Extensions\*
C:\Users\*\AppData\Local\Google\Chrome\User Data\Profile*\Extensions\*
# Firefox extensions
C:\Users\*\AppData\Roaming\Mozilla\Firefox\Profiles\*\extensions\*
C:\Users\*\AppData\Roaming\Mozilla\Firefox\Profiles\*\extensions.json
# Edge extensions
C:\Users\*\AppData\Local\Microsoft\Edge\User Data\Default\Extensions\*

# ---------------------------------------------------------------------------
# Section 15: Additional Suspicious Locations
# ---------------------------------------------------------------------------
C:\Windows\System32\config\RegBack\*
C:\$Recycle.Bin\*\*.exe
C:\$Recycle.Bin\*\*.dll
C:\Recovery\*.exe
C:\Windows\Prefetch\*.pf
C:\Users\*\AppData\Local\Microsoft\Windows\INetCache\*\*.exe
C:\Users\*\AppData\Local\Microsoft\Windows\Temporary Internet Files\*\*.exe
